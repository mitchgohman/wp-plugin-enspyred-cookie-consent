{"version":3,"file":"trackingBlocker-KBwDPJyS.js","sources":["../../src/core/consent.js","../../src/core/trackingBlocker.js"],"sourcesContent":["// Consent Manager - Handles localStorage for cookie consent choices\n\nconst STORAGE_KEY = \"enspyred_cookie_consent\";\nconst EXPIRY_MONTHS = 12;\n\n/**\n * Get current consent status\n * @returns {Object|null} Consent object or null if not set\n */\nexport const getConsent = () => {\n    try {\n        const stored = localStorage.getItem(STORAGE_KEY);\n        if (!stored) return null;\n\n        const consent = JSON.parse(stored);\n\n        // Check if expired\n        if (consent.expiresAt && Date.now() > consent.expiresAt) {\n            clearConsent();\n            return null;\n        }\n\n        return consent;\n    } catch (error) {\n        console.error(\"[Cookie Consent] Error reading consent:\", error);\n        return null;\n    }\n};\n\n/**\n * Set consent choice\n * @param {string} choice - 'accepted', 'opted-out', or 'dismissed'\n */\nexport const setConsent = (choice) => {\n    try {\n        const now = Date.now();\n        const expiresAt = now + EXPIRY_MONTHS * 30 * 24 * 60 * 60 * 1000; // ~12 months\n\n        const consent = {\n            choice,\n            timestamp: now,\n            expiresAt,\n        };\n\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(consent));\n        console.log(\"[Cookie Consent] Choice saved:\", choice);\n    } catch (error) {\n        console.error(\"[Cookie Consent] Error saving consent:\", error);\n    }\n};\n\n/**\n * Check if user has made a valid consent choice\n * @returns {boolean}\n */\nexport const hasValidConsent = () => {\n    const consent = getConsent();\n    return consent !== null;\n};\n\n/**\n * Check if user opted out\n * @returns {boolean}\n */\nexport const isOptedOut = () => {\n    const consent = getConsent();\n    return consent?.choice === \"opted-out\";\n};\n\n/**\n * Clear consent (for testing/reset)\n */\nexport const clearConsent = () => {\n    try {\n        localStorage.removeItem(STORAGE_KEY);\n        console.log(\"[Cookie Consent] Consent cleared\");\n    } catch (error) {\n        console.error(\"[Cookie Consent] Error clearing consent:\", error);\n    }\n};\n","// Tracking Blocker - Disables Google Analytics, Google Ads, and Microsoft Clarity\n\n/**\n * Block all tracking scripts\n */\nexport const blockAll = () => {\n    console.log('[Cookie Consent] Blocking all tracking scripts...');\n\n    blockGoogleAnalytics();\n    blockGoogleAds();\n    blockMicrosoftClarity();\n\n    console.log('[Cookie Consent] All tracking scripts blocked');\n};\n\n/**\n * Block Google Analytics\n */\nconst blockGoogleAnalytics = () => {\n    // Delete GA cookies\n    deleteGACookies();\n\n    // Disable GA globally\n    if (window.gtag) {\n        // Find GA measurement ID from dataLayer\n        const dataLayer = window.dataLayer || [];\n        const gaConfig = dataLayer.find(item =>\n            Array.isArray(item) && item[0] === 'config' && item[1]?.startsWith('G-')\n        );\n\n        if (gaConfig && gaConfig[1]) {\n            const measurementId = gaConfig[1];\n            window[`ga-disable-${measurementId}`] = true;\n            console.log('[Cookie Consent] GA disabled for:', measurementId);\n        }\n\n        // Generic disable\n        window['ga-disable'] = true;\n    }\n\n    // Disable classic GA\n    if (window.ga) {\n        window.ga = function() {};\n    }\n};\n\n/**\n * Delete Google Analytics cookies\n */\nconst deleteGACookies = () => {\n    const gaCookies = ['_ga', '_gid', '_gat', '_gat_gtag'];\n\n    gaCookies.forEach(cookieName => {\n        // Delete for current domain\n        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\n\n        // Delete for parent domain\n        const domain = window.location.hostname;\n        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=${domain};`;\n        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.${domain};`;\n    });\n\n    console.log('[Cookie Consent] GA cookies deleted');\n};\n\n/**\n * Block Google Ads\n */\nconst blockGoogleAds = () => {\n    if (window.gtag) {\n        // Disable conversion tracking\n        window.gtag('set', 'ads_data_redaction', true);\n        window.gtag('set', 'allow_ad_personalization_signals', false);\n\n        // Disable specific Google Ads account (AW-1050709691)\n        window.gtag('config', 'AW-1050709691', {\n            'send_page_view': false,\n            'allow_google_signals': false,\n            'allow_ad_personalization_signals': false\n        });\n\n        console.log('[Cookie Consent] Google Ads blocked');\n    }\n};\n\n/**\n * Block Microsoft Clarity\n */\nconst blockMicrosoftClarity = () => {\n    // Remove Clarity script if present\n    const clarityScripts = document.querySelectorAll('script[src*=\"clarity.ms\"]');\n    clarityScripts.forEach(script => {\n        script.remove();\n        console.log('[Cookie Consent] Clarity script removed');\n    });\n\n    // Disable Clarity if loaded\n    if (window.clarity) {\n        window.clarity = function() {};\n        console.log('[Cookie Consent] Clarity function disabled');\n    }\n\n    // Delete Clarity cookies\n    const clarityCookies = ['_clck', '_clsk', 'CLID', 'ANONCHK', 'MR', 'MUID', 'SM'];\n    clarityCookies.forEach(cookieName => {\n        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\n    });\n\n    console.log('[Cookie Consent] Clarity blocked and cookies deleted');\n};\n"],"names":["STORAGE_KEY","getConsent","stored","consent","clearConsent","error","setConsent","choice","now","expiresAt","hasValidConsent","isOptedOut","blockAll","blockGoogleAnalytics","blockGoogleAds","blockMicrosoftClarity","deleteGACookies","gaConfig","item","_a","measurementId","cookieName","domain","script"],"mappings":"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"}